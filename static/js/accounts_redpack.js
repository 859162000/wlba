// Generated by CoffeeScript 1.8.0
(function() {
  require.config({
    paths: {
      jquery: 'lib/jquery.min',
      tools: 'lib/modal.tools',
      "jquery.validate": 'lib/jquery.validate.min',
      'jquery.modal': 'lib/jquery.modal.min'
    },
    shims: {
      "jquery.modal": ["jquery"],
      "tools": ['jquery.modal']
    }
  });

  require(['jquery', 'tools'], function($, tool) {
    return $('.exchange').click(function(e) {
      var token;
      e.preventDefault();
      token = $.trim($('input[name="token"]').val());
      if (token !== '') {
        return $.post('/api/redpacket/exchange/', {
          token: token
        }).done(function(data) {
          console.log(data);
          if (data.ret_code === 0) {
            return tool.modalAlert({
              btnText: "确认",
              title: '温馨提示',
              msg: '兑换成功',
              callback_ok: function() {
                return window.location.reload();
              }
            });
          } else {
            return tool.modalAlert({
              btnText: "确认",
              title: '温馨提示',
              msg: data.message
            });
          }
        });
      } else {
        return tool.modalAlert({
          btnText: "确认",
          title: '温馨提示',
          msg: '兑换码不能为空'
        });
      }
    });
  });

}).call(this);
