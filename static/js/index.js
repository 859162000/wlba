// Generated by CoffeeScript 1.7.1
(function() {
  require.config({
    paths: {
      jquery: 'lib/jquery.min',
      underscore: 'lib/underscore-min',
      'jquery.modal': 'lib/jquery.modal.min'
    },
    shim: {
      'jquery.modal': ['jquery']
    }
  });

  require(['jquery', 'underscore', 'lib/backend', 'lib/modal'], function($, _, backend, modal) {
    var anchors, bannerCount, banners, currentBanner, trustId, trustName;
    $('.portfolio-submit').click(function() {
      var asset, period, risk;
      asset = $('#portfolio-asset')[0].value;
      period = $('#portfolio-period')[0].value;
      risk = $('#portfolio-risk')[0].value;
      return window.location.href = '/portfolio/?period=' + period + '&asset=' + asset + '&risk=' + risk;
    });
    $('.portfolio-input').keyup(function(e) {
      if (e.keyCode === 13) {
        return $('.portfolio-submit').click();
      }
    });
    currentBanner = 0;
    banners = $('*[class^="home-banner"]');
    bannerCount = banners.length;
    anchors = $('.background-anchor');
    setInterval(function() {
      $(banners[currentBanner]).hide();
      $(anchors[currentBanner]).toggleClass('active');
      currentBanner = (currentBanner + 1) % bannerCount;
      $(banners[currentBanner]).fadeIn();
      return $(anchors[currentBanner]).toggleClass('active');
    }, 6000);
    $('.background-anchor').click(function(e) {
      var index;
      e.preventDefault();
      index = $(e.target).parent().index();
      if (index !== currentBanner) {
        $(banners[currentBanner]).hide();
        $(anchors[currentBanner]).toggleClass('active');
        $(banners[index]).fadeIn();
        $(anchors[index]).toggleClass('active');
        return currentBanner = index;
      }
    });
    $('.home-banner-2').click(function() {
      return window.location.href = '/trust/detail/8526';
    });
    trustId = 0;
    trustName = '';
    $('.order-button').click(function(e) {
      e.preventDefault();
      trustId = $(e.target).attr('data-trust-id');
      trustName = $(e.target).attr('data-trust-name');
      return $(this).modal();
    });
    return $('#preorder_submit').click(function(event) {
      var name, phone;
      event.preventDefault();
      name = $('#name_input').val();
      phone = $('#phone_input').val();
      if (name && phone) {
        return backend.createPreOrder({
          product_url: trustId,
          product_type: 'trust',
          product_name: trustName,
          user_name: name,
          phone: phone
        }).done(function() {
          alert('预约成功，稍后我们的客户经理会联系您');
          $('#name_input').val('');
          $('#phone_input').val('');
          return $.modal.close();
        }).fail(function() {
          return alert('预约失败，请稍后再试或者拨打400-9999999');
        });
      }
    });
  });

}).call(this);

//# sourceMappingURL=index.map
