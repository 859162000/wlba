// Generated by CoffeeScript 1.7.1
(function() {
  define(['jquery', 'underscore', 'knockout'], function($, _, ko) {
    var viewModel;
    viewModel = (function() {
      function viewModel(context) {
        var self;
        self = this;
        self.columns = _(context.columns).map(function(item, index) {
          return _({
            sortable: false
          }).extend(item);
        });
        self.sortedColumn = ko.observable({
          column: null,
          order: 'asc'
        });
        self.data = ko.observable();
        self.events = {
          sortHandler: function(column, order) {
            var items;
            if (_.has(column, 'field')) {
              items = _.sortBy(self.data(), function(item) {
                return item[column.field];
              });
              if (order === 'asc') {
                return self.data(items);
              } else {
                return self.data(items.reverse());
              }
            }
          }
        };
        if (_.has(context, 'events')) {
          _(self.events).extend(context.events);
        }
        self.addToFavorite = function(data, e) {
          var id, is_favorited;
          e.preventDefault();
          id = $(e.target).attr('data-id');
          alert(id);
          is_favorited = $(e.target).attr('data-is-favorited');
          return backend.addToFavorite(e, 'trusts', id, is_favorited);
        };
        self.sortHandler = function(column) {
          var order, sortedColumn;
          sortedColumn = self.sortedColumn();
          order = 'asc';
          if (sortedColumn.column && sortedColumn.column.name === column.name) {
            if (sortedColumn.order === 'asc') {
              order = 'dsc';
            }
          }
          self.sortedColumn({
            column: column,
            order: order
          });
          if (_.has(self.events, 'sortHandler')) {
            return self.events.sortHandler(column, order);
          }
        };
      }

      return viewModel;

    })();
    return {
      viewModel: viewModel
    };
  });

}).call(this);

//# sourceMappingURL=table.map
