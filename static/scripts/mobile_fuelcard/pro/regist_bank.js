webpackJsonp([1],[function(t,n,e){(function(t){"use strict";var n=function(){function t(t,n){var e=[],r=!0,i=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done)&&(e.push(o.value),!n||e.length!==n);r=!0);}catch(s){i=!0,a=s}finally{try{!r&&u["return"]&&u["return"]()}finally{if(i)throw a}}return e}return function(n,e){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return t(n,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=e(3),i=e(5),a=e(2),o=e(4);e(6);!function(){function e(n){return new Promise(function(e,i){(0,a.ajax)({url:n,type:"POST",data:{phone:l.val(),vcode:d.val(),order_id:t("input[name=order_id]").val(),token:t("input[name=token]").val(),set_the_one_card:!0},beforeSend:function(){u.text("绑定中,请稍等...").attr("disabled","true")},success:function(t){return t.ret_code>0?(i(t.message),(0,r.ui_signError)(t.message)):(0,r.ui_alert)("恭喜你，绑卡成功！",function(){e(t.message),window.location.href="/fuel_card/regist/end/"})},error:function(t){i(t)},complete:function(){u.text("绑定银行卡").removeAttr("disabled")}})})}var u=t("button[type=submit]"),s=t("select[name=bank]"),c=t("input[name=bankcard]"),l=t("input[name=bankphone]"),d=t("input[name=validation]"),f=t("button[name=validate_operation]"),v=[{target:s,required:!0},{target:c,required:!0},{target:l,required:!0},{target:d,required:!0}];~function(){function n(t){var n=/^\d{5,}$/,e=/^\d{4}$/;return n.test(t)?t.replace("0000","")+"万":e.test(t)?t.replace("000","")+"千":void 0}function e(e){for(var r=t(".limit-bank-item"),i="",a=0;a<e.length;a++)i+="\n                        <div class='limit-bank-list'>\n                            <div class='limit-list-dec'>\n                                <div class='bank-name'>"+e[a].name+"</div>\n                                <div class='bank-limit'>首次限额"+n(e[a].first_one)+"/单笔限额"+n(e[a].first_one)+"/日限额"+n(e[a].second_day)+"</div>\n                            </div>\n                            <div class='limit-list-icon "+e[a].bank_id+"'></div>\n                        </div>";r.html(i)}function i(t){var n="";for(var e in t)n+="<option value = '"+t[e].gate_id+"' >"+t[e].name+"</option>";return n}if(localStorage.getItem("bank")){var o=JSON.parse(localStorage.getItem("bank"));return e(o),s.append(i(o))}(0,a.ajax)({type:"POST",url:"/api/bank/list_new/",success:function(t){if(0!==t.ret_code)return(0,r.ui_signError)(t.message);var n=JSON.stringify(t.banks);e(n),s.append(i(t.banks)),window.localStorage.setItem("bank",n)},error:function(t){console.log(t)}})}();var m=new i.Automatic({submit:u,checklist:v});m.operation(),t("select[name=bank]").change(function(){var n=t(this).attr("data-icon");""==t(this).val()?t(this).siblings("."+n).removeClass("active"):t(this).siblings("."+n).addClass("active"),t("input[name=password]").trigger("input")});var p=function(){return new Promise(function(t,e){function i(){var t=[{type:"isEmpty",value:s.val()},{type:"bankCard",value:c.val()},{type:"phone",value:l.val()}];return(0,o.check)(t)}var a=i(),u=n(a,2),d=u[0],f=u[1];return d?t("验证成功"):((0,r.ui_signError)(f),console.log("验证失败"))})},h=function(n){return new Promise(function(e,i){(0,a.ajax)({url:n,type:"POST",data:{card_no:c.val(),amount:.01,phone:l.val(),gate_id:s.val()},beforeSend:function(){f.attr("disabled","disabled").text("发送中..")},success:function(n){return 0===n.ret_code?((0,r.ui_signError)("短信已发送，请注意查收！"),t("input[name='order_id']").val(n.order_id),t("input[name='token']").val(n.token),e("短信已发送，请注意查收！")):n.ret_code>0?((0,r.ui_signError)(n.message),i("获取短信验证码错误")):void 0},error:function(t){i(t)},complete:function(){f.removeAttr("disabled").text("获取验证码")}})})},g=function(t){return new Promise(function(n,e){var i=function(){return t>1?(t--,f.text(t+"秒后可重发")):(clearInterval(intervalId),f.text("重新获取").removeAttr("disabled"),(0,r.ui_signError)("倒计时失效，请重新获取"),e("倒计时失效，请重新获取"))};return i(),intervalId=setInterval(i,1e3)})};f.on("click",function(){p().then(function(t){return console.log(t),h("/api/pay/deposit_new/")}).then(function(t){console.log("短信发送成功，自信倒计时");var n=60;return g(n)})["catch"](function(t){console.log(t)})});var y=function(){return new Promise(function(t,e){function i(){var t=[{type:"isEmpty",value:s.val()},{type:"bankCard",value:c.val()},{type:"phone",value:l.val()},{type:"isEmpty",value:d.val()}];return(0,o.check)(t)}var a=i(),u=n(a,2),f=u[0],v=u[1];return f?t("验证成功"):((0,r.ui_signError)(v),console.log("验证失败"))})};u.on("click",function(){y().then(function(t){return console.log(t),e("/api/pay/cnp/dynnum_new/")}).then(function(t){console.log(t)})["catch"](function(t){console.log(result)})})}()}).call(n,e(1))},,function(t,n,e){(function(t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=(n.ajax=function(n){t.ajax({url:n.url,type:n.type,data:n.data,dataType:n.dataType,async:n.async||!0,beforeSend:function(t,a){n.beforeSend&&n.beforeSend(t),!r(a.type)&&i(a.url)&&t.setRequestHeader("X-CSRFToken",e("csrftoken"))},success:function(t){n.success&&n.success(t)},error:function(t){n.error&&n.error(t)},complete:function(){n.complete&&n.complete()}})},n.getCookie=function(n){var e=void 0,r=void 0,i=void 0,a=null;if(document.cookie&&""!==document.cookie)for(r=document.cookie.split(";"),i=0;i<r.length;){if(e=t.trim(r[i]),e.substring(0,n.length+1)===n+"="){a=decodeURIComponent(e.substring(n.length+1));break}i++}return a}),r=function(t){return/^(GET|HEAD|OPTIONS|TRACE)$/.test(t)},i=function(t){var n=void 0,e=void 0,r=void 0,i=void 0;return n=document.location.host,r=document.location.protocol,i="//"+n,e=r+i,t===e||t.slice(0,e.length+1)===e+"/"||t===i||t.slice(0,i.length+1)===i+"/"||!/^(\/\/|http:|https:).*/.test(t)}}).call(n,e(1))},function(t,n,e){(function(t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.ui_alert=function(n,e){var r=t(".fuel-alert"),i=t(".fuel-submit");r.css("display","-webkit-box").find(".fuel-text").text(n),i.on("click",function(){r.hide(),e&&e()})},n.ui_confirm=function(n){var e=arguments.length<=1||void 0===arguments[1]?"确定":arguments[1],r=arguments.length<=2||void 0===arguments[2]?null:arguments[2],i=arguments.length<=3||void 0===arguments[3]?null:arguments[3],a=t(".confirm-warp");a.length<=0||(a.show(),a.find(".confirm-text").text(n),a.find(".confirm-certain").text(e),a.find(".confirm-cancel").on("click",function(){a.hide()}),a.find(".confirm-certain").on("click",function(){a.hide(),r&&(i?r(i):r())}))},n.ui_signError=function(n){t(".error-sign").html(n).removeClass("moveDown").addClass("moveDown").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){t(this).removeClass("moveDown")})}}).call(n,e(1))},function(t,n,e){(function(t){"use strict";var e=function(){function t(t,n){var e=[],r=!0,i=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done)&&(e.push(o.value),!n||e.length!==n);r=!0);}catch(s){i=!0,a=s}finally{try{!r&&u["return"]&&u["return"]()}finally{if(i)throw a}}return e}return function(n,e){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return t(n,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();Object.defineProperty(n,"__esModule",{value:!0});var r=(n.check=function(n){var i=null,a=null;return t.each(n,function(t,n){var o=r[n.type](n.value),u=e(o,2);return i=u[0],a=u[1],i?void 0:!1}),[i,a]},{phone:function i(n){var i=parseInt(t.trim(n)),e="请输入正确的手机号",r=new RegExp(/^(12[0-9]|13[0-9]|15[0123456789]|18[0123456789]|14[57]|17[0678])[0-9]{8}$/);return r.test(i)?[!0,""]:[!1,e]},password:function(n){var e="密码为6-20位数字/字母/符号/区分大小写",r=new RegExp(/^\d{6,20}$/);return r.test(t.trim(n))?[!0,""]:[!1,e]},rePassword:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.psw,e=void 0===n?null:n,r=t.repeatPsw,i=void 0===r?null:r,a="两次密码不相同";return e!==i?[!1,a]:[!0,""]},tranPassword:function(n){var e="交易密码为6位数字",r=new RegExp(/^\d{6}$/);return r.test(t.trim(n))&&!isNaN(t.trim(n))?[!0,""]:[!1,e]},bankCard:function(n){var e="银行卡号不正确",r=new RegExp(/^\d{12,20}$/);return r.test(t.trim(n))&&!isNaN(t.trim(n))?[!0,""]:[!1,e]},idCard:function(n){var e="身份证号不正确",r=new RegExp(/^.{15,18}$/);return r.test(t.trim(n))&&!isNaN(t.trim(n))?[!0,""]:[!1,e]},money100:function(t){var n="请输入100的倍数金额";return t%100===0?[!0,""]:[!1,n]},isEmpty:function(t){var n="请填写全部的表单";return""===t?[!1,n]:[!0,""]}})}).call(n,e(1))},function(t,n,e){(function(t){"use strict";function e(t){if(Array.isArray(t)){for(var n=0,e=Array(t.length);n<t.length;n++)e[n]=t[n];return e}return Array.from(t)}function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}();Object.defineProperty(n,"__esModule",{value:!0});n.Automatic=function(){function n(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=t.submit,i=void 0===e?null:e,a=t.checklist,o=void 0===a?[]:a,u=t.otherlist,s=void 0===u?[]:u;r(this,n);var c=[i,s,o];this.submit=c[0],this.otherlist=c[1],this.checklist=c[2],this.allCheck=this.allRequire(),this.canSubmit=this.canSubmit.bind(this),this.isEmptyString=this.isEmptyString.bind(this),this.isEmptyArray=this.isEmptyArray.bind(this),this.check()}return i(n,[{key:"allRequire",value:function(){var t=[].concat(e(this.checklist),e(this.otherlist));return t.filter(function(t){return t.required?!0:!1})}},{key:"isEmptyArray",value:function(t){return 0===t.length?!0:!1}},{key:"isEmptyString",value:function(t){return""==t?!0:!1}},{key:"check",value:function(){if(this.isEmptyArray(this.checklist))return console.log("checklist is none");var t=this;this.checklist.forEach(function(n){n.target.on("input",function(){t.style(n.target),t.canSubmit()})})}},{key:"style",value:function(n){var e=this.isEmptyString(n.val()),r=n.attr("data-icon"),i=n.attr("data-other"),a=n.attr("data-operation");e&&(""!=r&&n.siblings("."+r).removeClass("active"),""!=i&&t("."+i).attr("disabled","true"),""!=a&&n.siblings("."+a).hide()),e||(""!=r&&n.siblings("."+r).addClass("active"),""!=i&&t("."+i).removeAttr("disabled"),""!=a&&n.siblings("."+a).show())}},{key:"canSubmit",value:function(){var t="text|tel|password|select|",n=this,e=this.allCheck.every(function(e){var r=e.target;return t.indexOf(r.attr("type"))>=0?n.isEmptyString(r.val())?!1:!0:t.indexOf(e.target)<0?"checkbox"==r.attr("type")&&r.prop("checked")?!0:!1:void 0});e?this.submit.removeAttr("disabled"):this.submit.attr("disabled","true")}},{key:"operation",value:function(){t(".fuel-clear-input").on("click",function(){t(this).siblings("input").val("").trigger("input")})}},{key:"operationPassword",value:function(){t(".fuel-password-operation").on("click",function(){var n=t(this).siblings("input").attr("type");"text"==n&&(t(this).siblings().attr("type","password"),t(this).addClass("fuel-hide-password").removeClass("fuel-show-password")),"password"==n&&(t(this).siblings().attr("type","text"),t(this).addClass("fuel-show-password").removeClass("fuel-hide-password"))})}}]),n}()}).call(n,e(1))},function(t,n,e){(function(t){"use strict";var r=function(){function t(t,n){var e=[],r=!0,i=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done)&&(e.push(o.value),!n||e.length!==n);r=!0);}catch(s){i=!0,a=s}finally{try{!r&&u["return"]&&u["return"]()}finally{if(i)throw a}}return e}return function(n,e){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return t(n,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();Object.defineProperty(n,"__esModule",{value:!0}),n.validation=void 0;var i=e(3),a=e(2),o=e(4);n.validation=function u(n,e,s,c){function u(){var n="/captcha/refresh/?v="+(new Date).getTime();t.get(n,function(t){c.attr("src",t.image_url),e.val(t.key)})}function l(t,n,e){return new Promise(function(r,i){(0,a.ajax)({url:"/api/phone_validation_code/"+t+"/",data:{captcha_0:n,captcha_1:e},type:"POST",beforeSend:function(){m.attr("disabled","disabled").text("发送中..")},success:function(){r("短信已发送，请注意查收！")},error:function(t){var n=JSON.parse(t.responseText);return m.removeAttr("disabled").text("获取验证码"),clearInterval(v),u(),i(n.message)}})})}function d(t){return new Promise(function(n,e){var r=function(){return t>1?(t--,m.text(t+"秒后可重发")):(clearInterval(v),m.text("重新获取").removeAttr("disabled"),u(),e("倒计时失效，请重新获取"))};return r(),v=setInterval(r,1e3)})}function f(t,n,e){p(t).then(function(){return console.log("验证成功"),l(t,n,e)}).then(function(t){(0,i.ui_signError)(t),console.log("短信发送成功");var n=60;return d(n)})["catch"](function(t){(0,i.ui_signError)(t)})}var v=null,m=t("button[name=validate_operation]");u();var p=function(t){return new Promise(function(n,e){function i(){var n=[{type:"phone",value:t}];return(0,o.check)(n)}var a=i(),u=r(a,2),s=u[0],c=u[1];return s?n("验证成功"):e(c)})};c.on("click",function(){u()}),m.on("click",function(){var t=n.val(),r=e.val(),i=s.val();f(t,r,i)})}}).call(n,e(1))}]);