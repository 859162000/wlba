webpackJsonp([7],[function(t,n,e){(function(t){"use strict";var n=function(){function t(t,n){var e=[],r=!0,i=!1,o=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(e.push(a.value),!n||e.length!==n);r=!0);}catch(u){i=!0,o=u}finally{try{!r&&c["return"]&&c["return"]()}finally{if(i)throw o}}return e}return function(n,e){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return t(n,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=e(6),i=e(3),o=e(2),a=e(4);!function(){function e(t){return new Promise(function(n,e){(0,i.ajax)({url:t,type:"POST",data:{identifier:u.val(),password:s.val()},beforeSend:function(){c.text("登录中,请稍等...").attr("disabled","true")},success:function(t){n(t)},error:function(t){e(t)},complete:function(){c.text("登录网利宝").removeAttr("disabled")}})})}var c=t("button[type=submit]"),u=t("input[name=identifier]"),s=t("input[name=password]"),l=[{target:u,required:!0},{target:s,required:!0}],f=new r.Automatic({submit:c,checklist:l});f.operationClear(),f.operationPassword();var d=function(){return new Promise(function(t,e){function r(){var t=[{type:"phone",value:u.val()},{type:"password",value:s.val()}];return(0,a.check)(t)}var i=r(),c=n(i,2),l=c[0],f=c[1];return l?t("验证成功"):((0,o.signModel)(f),console.log("验证失败"))})};c.on("click",function(){d().then(function(t){return console.log(t),e("/weixin/api/login/")}).then(function(t){console.log("login success");var n=(0,i.getQueryStringByName)("next");window.location.href=n?decodeURIComponent(decodeURIComponent(n)):"/weixin/account/"})["catch"](function(t){if(403==t.status)return(0,o.signModel)("请勿重复提交"),!1;var n=JSON.parse(t.responseText);for(var e in n)n.__all__?(0,o.signModel)(n.__all__[0]):(0,o.signModel)(n[e][0])})})}()}).call(n,e(1))},,function(t,n,e){(function(t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.Alert=function(n,e){var r=t(".wx-alert"),i=t(".wx-submit");r.css("display","-webkit-box").find(".wx-text").text(n),i.on("click",function(){r.hide(),e()})},n.Confirm=function(n){var e=arguments.length<=1||void 0===arguments[1]?"确定":arguments[1],r=arguments.length<=2||void 0===arguments[2]?null:arguments[2],i=arguments.length<=3||void 0===arguments[3]?null:arguments[3],o=t(".confirm-warp");o.length<=0||(o.show(),o.find(".confirm-text").text(n),o.find(".confirm-certain").text(e),o.find(".confirm-cancel").on("click",function(){o.hide()}),o.find(".confirm-certain").on("click",function(){o.hide(),r&&(i?r(i):r())}))},n.signModel=function(n){t(".error-sign").html(n).removeClass("moveDown").addClass("moveDown").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){t(this).removeClass("moveDown")})}}).call(n,e(1))},,function(t,n,e){(function(t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=function(){function t(t,n){var e=[],r=!0,i=!1,o=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(e.push(a.value),!n||e.length!==n);r=!0);}catch(u){i=!0,o=u}finally{try{!r&&c["return"]&&c["return"]()}finally{if(i)throw o}}return e}return function(n,e){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return t(n,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=(n.check=function(n){var i=null,o=null;return t.each(n,function(t,n){var a=r[n.type](n.value),c=e(a,2);return i=c[0],o=c[1],i?void 0:!1}),[i,o]},{phone:function i(n){var i=parseInt(t.trim(n)),e="请输入正确的手机号",r=new RegExp(/^(12[0-9]|13[0-9]|15[0123456789]|18[0123456789]|14[57]|17[0678])[0-9]{8}$/);return r.test(i)?[!0,""]:[!1,e]},password:function(n){var e="密码为6-20位数字/字母/符号/区分大小写",r=new RegExp(/^\d{6,20}$/);return r.test(t.trim(n))?[!0,""]:[!1,e]},rePassword:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.psw,e=void 0===n?null:n,r=t.repeatPsw,i=void 0===r?null:r,o="两次密码不相同";return e!==i?[!1,o]:[!0,""]},tranPassword:function(n){var e="交易密码为6位数字",r=new RegExp(/^\d{6}$/);return r.test(t.trim(n))&&!isNaN(t.trim(n))?[!0,""]:[!1,e]},bankCard:function(n){var e="银行卡号不正确",r=new RegExp(/^\d{12,20}$/);return r.test(t.trim(n))&&!isNaN(t.trim(n))?[!0,""]:[!1,e]},idCard:function(n){var e="身份证号不正确",r=new RegExp(/^([0-9]{17}([0-9]|x|X){1})|([0-9]{15})$/);return r.test(t.trim(n))?[!0,""]:[!1,e]},money100:function(t){var n="请输入100的倍数金额";return t%100===0?[!0,""]:[!1,n]},isEmpty:function(t){var n="请填写全部的表单";return""===t?[!1,n]:[!0,""]},isMoney:function(t){var n="请正确填写金额",e=1*t;return!isNaN(e)&&e>0?[!0,""]:[!1,n]}})}).call(n,e(1))},function(t,n,e){(function(t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.validation=n.timeIntervalId=void 0;var r=function(){function t(t,n){var e=[],r=!0,i=!1,o=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(e.push(a.value),!n||e.length!==n);r=!0);}catch(u){i=!0,o=u}finally{try{!r&&c["return"]&&c["return"]()}finally{if(i)throw o}}return e}return function(n,e){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return t(n,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=e(3),o=e(2),a=e(4),c=n.timeIntervalId=null;n.validation=function u(e,s,l,f){function u(){var n="/captcha/refresh/?v="+(new Date).getTime();t.get(n,function(t){f.attr("src",t.image_url),s.val(t.key)})}function d(t,n,e){return new Promise(function(r,o){(0,i.ajax)({url:"/api/phone_validation_code/"+t+"/",data:{captcha_0:n,captcha_1:e},type:"POST",beforeSend:function(){p.attr("disabled","disabled").text("发送中..")},success:function(){r("短信已发送，请注意查收！")},error:function(t){var n=JSON.parse(t.responseText);return p.removeAttr("disabled").text("获取验证码"),clearInterval(c),u(),o(n.message)}})})}function v(t){return new Promise(function(e,r){var i=function(){return t>1?(t--,p.text(t+"秒后可重发")):(clearInterval(c),p.text("重新获取").removeAttr("disabled"),u(),r("倒计时失效，请重新获取"))};return i(),n.timeIntervalId=c=setInterval(i,1e3)})}function h(t,n,e){m(t).then(function(){return console.log("验证成功"),d(t,n,e)}).then(function(t){(0,o.signModel)(t),console.log("短信发送成功");var n=60;return v(n)})["catch"](function(t){(0,o.signModel)(t)})}var p=t("button[name=validate_operation]");u();var m=function(t){return new Promise(function(n,e){function i(){var n=[{type:"phone",value:t}];return(0,a.check)(n)}var o=i(),c=r(o,2),u=c[0],s=c[1];return u?n("验证成功"):e(s)})};f.on("click",function(){u()}),p.on("click",function(){var t=e.val(),n=s.val(),r=l.val();h(t,n,r)})}}).call(n,e(1))},function(t,n,e){(function(t){"use strict";function r(t){if(Array.isArray(t)){for(var n=0,e=Array(t.length);n<t.length;n++)e[n]=t[n];return e}return Array.from(t)}function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0}),n.Automatic=void 0;var o=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),a=e(5);n.Automatic=function(){function n(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=t.submit,r=void 0===e?null:e,o=t.checklist,a=void 0===o?[]:o,c=t.otherlist,u=void 0===c?[]:c,s=t.done,l=void 0===s?null:s;i(this,n);var f=[r,u,a,l];this.submit=f[0],this.otherlist=f[1],this.checklist=f[2],this.callback=f[3],this.allCheck=this.allRequire(),this.canSubmit=this.canSubmit.bind(this),this.isEmptyString=this.isEmptyString.bind(this),this.isEmptyArray=this.isEmptyArray.bind(this),this.check()}return o(n,[{key:"allRequire",value:function(){var t=[].concat(r(this.checklist),r(this.otherlist));return t.filter(function(t){return!!t.required})}},{key:"isEmptyArray",value:function(t){return 0===t.length}},{key:"isEmptyString",value:function(t){return""==t}},{key:"check",value:function(){if(this.isEmptyArray(this.checklist))return console.log("checklist is none");var t=this,n=null;this.checklist.forEach(function(e){var r="select"===e.target.attr("type")?"change":"input";e.target.on(r,function(){t.style(e.target),n=t.canSubmit(),t.callback&&t.callback(n)})})}},{key:"style",value:function(n){var e=this.isEmptyString(n.val()),r=n.attr("data-icon"),i=n.attr("data-other"),o=n.attr("data-operation");e&&(""!=r&&n.siblings("."+r).removeClass("active"),""!=i&&t("."+i).attr("disabled","true"),""!=o&&n.siblings("."+o).hide()),e||(""!=r&&n.siblings("."+r).addClass("active"),""!=i&&(t("."+i).removeAttr("disabled"),a.timeIntervalId&&(clearInterval(a.timeIntervalId),t("."+i).text("获取验证码"))),""!=o&&n.siblings("."+o).show())}},{key:"canSubmit",value:function(){var t="text|tel|password|select|",n=this,e=this.allCheck.every(function(e){var r=e.target;return t.indexOf(r.attr("type"))>=0?!n.isEmptyString(r.val()):t.indexOf(e.target)<0?"checkbox"==r.attr("type")&&r.prop("checked")?!0:0==e.target.length:void 0});return e?this.submit.removeAttr("disabled"):this.submit.attr("disabled","true"),e}},{key:"operationClear",value:function(){t(".wx-clear-input").on("click",function(){t(this).siblings("input").val("").trigger("input")})}},{key:"operationPassword",value:function(){t(".wx-password-operation").on("click",function(){var n=t(this).siblings("input").attr("type");"text"==n&&(t(this).siblings().attr("type","password"),t(this).addClass("wx-hide-password").removeClass("wx-show-password")),"password"==n&&(t(this).siblings().attr("type","text"),t(this).addClass("wx-show-password").removeClass("wx-hide-password"))})}}]),n}()}).call(n,e(1))}]);